<!--[include file="nl_admin_menu.htm"]-->
<div style="width:80%; margin:0px auto;">
	<form name="show_template" action="#">
		<table style="width:100%; border:1px solid #ccc; padding:10px;">
			<tr>
				<th><!--[pnml name="_PREVIEW_TEMPLATES"]--></th>
			</tr>
			<tr>
				<td style="text-align:center;">
				<img src="modules/Newsletter/pnimages/demo.gif" alt="" />
					<select name="nl_type" onchange="window.location=this.options[selectedIndex].value" >						
						<option><!--[pnml name="_SELECT"]--></option>
						<option value="index.php?module=Newsletter&type=admin&func=display_template&nl_type=1"><!--[pnml name="_TEXT"]--></option>
						<option value="index.php?module=Newsletter&type=admin&func=display_template&nl_type=2"><!--[pnml name="_HTML"]--></option>
						<option value="index.php?module=Newsletter&type=admin&func=display_template&nl_type=3"><!--[pnml name="_TEXTWLINK"]--></option>
					</select>
				</td>
			</tr>
		</table>
	</form>

	<form name="config" action="<!--[pnmodurl modname="Newsletter" type="admin" func="config_update"]-->" method="post">
	<table style="width:100%; border:1px solid #ccc; padding:10px;">
		<tr>
			<th colspan="2"><!--[pnml name="_CONFIGURATION"]--></th>
		</tr>
		<tr>
			<td><!--[pnml name="_SEND_NEWSLETTERS_FROM"]--></td>
			<td><input name="send_from_address" type="text" value="<!--[pnmodgetvar module="Newsletter" name="send_from_address"]-->" style="width:180px;" /></td>
		</tr>
		<tr>
			<td><!--[pnml name="_ARCHIVE_TYPE"]--></td>
			<td>
				<input name="archive_type" type="radio" value="1" <!--[$archive_type_1_checked]-->/> <!--[pnml name="_DATABASE"]-->
				&nbsp;|&nbsp;
				<input name="archive_type" type="radio" value="2" <!--[$archive_type_2_checked]-->/> <!--[pnml name="_FILE"]-->
			</td>
		</tr>
		<tr>
			<td>Archive Directory <span style="color:red;"><!--[$archive_directory_warning]--></span></td>
			<td><input name="archive_directory" type="text" value="<!--[pnmodgetvar module="Newsletter" name="archive_directory"]-->" style="width:180px;" /></td>
		</tr>
		<tr>
			<td>Expire Archived Newsletters:</td>
			<td>
				<select name="archive_expire">
					<!--[html_options values="$archive_expire_values" output="$archive_expire_output" selected="$archive_expire_selected"]-->
				</select>
			</td>
		</tr>
		<tr>
			<td>Receive subscription notices?</td>
			<td><input name="notify_admin" type="checkbox" value="1" <!--[$notify_admin_checked]-->/> checked=yes</td>
		</tr>
		<tr>
			<td>Allow anonymous registrations?</td>
			<td><input name="allow_anon_registration" type="checkbox" value="1" <!--[$allow_anon_registration_checked]-->/> checked=yes</td>
		</tr>
		<tr>
			<td>Auto-Approve registrations?</td>
			<td><input name="auto_approve_registrations" type="checkbox" value="1" <!--[$auto_approve_registrations_checked]-->/> checked=yes</td>
		</tr>
		<tr>
			<td>Default Newsletter type:</td>
			<td>
				<select name="default_type">
					<!--[html_options values="$default_type_values" output="$default_type_output" selected="$default_type_selected"]-->
				</select>
			</td>
		</tr>
		<tr>
			<td>Default Frequency:</td>
			<td>
				<select name="default_frequency" onchange="if(this.options[selectedIndex].value=='0'){document.forms[0].allow_frequency_change.checked=false; document.forms[0].allow_frequency_change.disabled = true; } else { document.forms[0].allow_frequency_change.disabled = false;}">
					<!--[html_options values="$frequency_values" output="$frequency_output" selected="$frequency_selected"]-->
				</select>
			</td>
		</tr>
		<tr>
			<td>Allow frequency changes?</td>
			<td><input name="allow_frequency_change" type="checkbox" value="1" <!--[$allow_frequency_change_checked]-->/> checked=yes</td>
		</tr>
		<tr>
			<td>Send Day:</td>
			<td>
				<select name="send_day">
					<!--[html_options values="$send_days_values" output="$send_days_output" selected="$send_days_selected"]-->
				</select>
			</td>
		</tr>
		<tr>
			<td>Send Per Request?</td>
			<td><input name="send_per_request" type="text" value="<!--[pnmodgetvar module="Newsletter" name="send_per_request"]-->" style="width:30px;" /> "x" number of emails</td>
		</tr>
		<tr>
			<td>Maximum send per hour</td>
			<td><input name="max_send_per_hour" type="text" value="<!--[pnmodgetvar module="Newsletter" name="max_send_per_hour"]-->" style="width:30px;" /> "x" number of emails <em>(0 [zero] = no limit)</em></td>
		</tr>
		<tr>
			<td>Personalize email?</td>
			<td><input name="personalize_email" type="checkbox" value="1" <!--[$personalize_email_checked]-->/> <em>(disable to increase performance)</em></td>
		</tr>
		<tr>
			<td>Admin Key</td>
			<td><input name="admin_key" type="text" value="<!--[pnmodgetvar module="Newsletter" name="admin_key"]-->" style="width:100px;" /> used to simplify cron/batch processing.</td>
		</tr>
		<tr>
			<td colspan="2" style="height:20px;"></td>
		</tr>
		<tr>
			<td></td>
			<td><input type="submit" name="submit" value="update configuration" />
		</tr>
		<input type="hidden" name="authid" value="<!--[pnsecgenauthkey module="Newsletter"]-->" />
	</table>
	</form>
	
	<div style="border:1px solid #ccc; padding:10px; margin:10px auto;">
			<p>it took <!--[$last_execution_time]--> seconds to send the last batch.</p>
	</div>
	
	<form action="<!--[pnmodurl modname="Newsletter" type="admin" func="flush_archives"]-->" method="post" onsubmit="if(!this.file_archive.checked && !this.db_archive.checked){alert('Please select an archive to flush.'); return false;}">
	<table style="width:100%; border:1px solid #ccc; padding:10px;">
		<tr>
			<th colspan="2">Prune Archives</th>
		</tr>
		<tr>
			<td colspan="2">
				<p><strong>Note:</strong> This option will remove all selected archives from the server.</p>
			</td>
		</tr>
		<tr>
			<td style="text-align:right;">File Archives:</td>
			<td><input type="checkbox" name="file_archive" value="1" /> <em>(checked=yes)</em></td>
		</tr>
		<tr>
			<td style="text-align:right;">Database Archives:</td>
			<td><input type="checkbox" name="db_archive" value="1" /> <em>(checked=yes)</em></td>
		</tr>
		<tr>
			<td colspan="2" style="height:20px;"></td>
		</tr>
		<tr>
			<td></td>
			<td><input type="submit" name="submit" value="prune archives" />
		</tr>
		<input type="hidden" name="authid" value="<!--[pnsecgenauthkey module="Newsletter"]-->" />
	</table>
	</form>
</div>